<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/Data/Constants.json">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Data/Constants.json" />
              <option name="updatedContent" value="{&#10;  &quot;PlayerBaseMaxHP&quot;: 100.0,&#10;  &quot;StoutGeneHPMultiplier&quot;: 20.0,&#10;  &quot;BaseAttackPower&quot;: 10.0,&#10;  &quot;BaseDefense&quot;: 5.0,&#10;  &quot;StrongGeneAttackMultiplier&quot;: 5.0,&#10;  &quot;ResilientGeneDefenseMultiplier&quot;: 3.0,&#10;  &quot;QuickGeneSpeedMultiplier&quot;: 1.0,&#10;  &quot;SmartGeneXPMultiplier&quot;: 1.0,&#10;  &quot;StealthyGeneDetectionMultiplier&quot;: 1.0&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Scripts/Actions/ActionWithCost.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Scripts/Actions/ActionWithCost.cs" />
              <option name="updatedContent" value="using GoRogue.GameFramework;&#10;using Mut8.Scripts.MapObjects;&#10;using Mut8.Scripts.MapObjects.Components;&#10;&#10;namespace Mut8.Scripts.Actions;&#10;&#10;internal abstract class ActionWithCost&#10;{&#10;    protected RogueLikeEntity Actor { get; }&#10;    private int _baseCost;&#10;&#10;    protected ActionWithCost(RogueLikeEntity actor, int baseCost)&#10;    {&#10;        Actor = actor;&#10;        _baseCost = baseCost;&#10;    }&#10;&#10;    public int GetCost()&#10;    {&#10;        Stats? stats = Actor.GetSadComponent&lt;Stats&gt;();&#10;        if (stats == null)&#10;        {&#10;            return _baseCost;&#10;        }&#10;&#10;        float speedMultiplier = stats.GetSpeedMultiplier();&#10;        return (int)Math.Max(1, Math.Round(_baseCost * speedMultiplier));&#10;    }&#10;&#10;    public abstract ActionResult Perform();&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Scripts/Factories/MapObjectFactory.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Scripts/Factories/MapObjectFactory.cs" />
              <option name="originalContent" value="using Newtonsoft.Json.Linq;&#10;using Mut8.Scripts;&#10;&#10;public class MapObjectFactory&#10;{&#10;    public void Initialize()&#10;    {&#10;        // Load game data first&#10;        GameData.LoadData();&#10;        &#10;        // Setup entity factories using loaded data&#10;        SetupEntityFactories();&#10;        SetupTerrainFactories();&#10;    }&#10;&#10;    private void SetupEntityFactories()&#10;    {&#10;        foreach (var entityKey in GameData.Entities.Keys)&#10;        {&#10;            var entityData = GameData.GetEntityData(entityKey);&#10;            // Use entityData to configure your AdvancedFactory&#10;            // Example: CreateEntityFactory(entityKey, entityData);&#10;        }&#10;    }&#10;&#10;    private void SetupTerrainFactories()&#10;    {&#10;        foreach (var terrainKey in GameData.Terrain.Keys)&#10;        {&#10;            var terrainData = GameData.GetTerrainData(terrainKey);&#10;            // Use terrainData to configure your AdvancedFactory&#10;            // Example: CreateTerrainFactory(terrainKey, terrainData);&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="using Newtonsoft.Json.Linq;&#10;using Mut8.Scripts;&#10;&#10;public class MapObjectFactory&#10;{&#10;    public void Initialize()&#10;    {&#10;        // Load game data first&#10;        GameData.LoadData();&#10;        &#10;        // Setup entity factories using loaded data&#10;        SetupEntityFactories();&#10;        SetupTerrainFactories();&#10;    }&#10;&#10;    private void SetupEntityFactories()&#10;    {&#10;        foreach (var entityKey in GameData.Entities.Keys)&#10;        {&#10;            var entityData = GameData.GetEntityData(entityKey);&#10;            &#10;            // Create an AdvancedFactory for each entity type&#10;            var factory = new AdvancedFactory&lt;Entity&gt;(() =&gt; {&#10;                var entity = new Entity();&#10;                &#10;                // Configure entity from JSON data&#10;                entity.Name = entityData[&quot;name&quot;]?.Value&lt;string&gt;() ?? entityKey;&#10;                entity.MaxHP = entityData[&quot;maxHP&quot;]?.Value&lt;float&gt;() ?? 100f;&#10;                entity.CurrentHP = entity.MaxHP;&#10;                entity.Attack = entityData[&quot;attack&quot;]?.Value&lt;float&gt;() ?? 10f;&#10;                entity.Defense = entityData[&quot;defense&quot;]?.Value&lt;float&gt;() ?? 5f;&#10;                entity.Speed = entityData[&quot;speed&quot;]?.Value&lt;float&gt;() ?? 5f;&#10;                &#10;                if (entityData[&quot;xpReward&quot;] != null)&#10;                {&#10;                    entity.XPReward = entityData[&quot;xpReward&quot;].Value&lt;int&gt;();&#10;                }&#10;                &#10;                return entity;&#10;            });&#10;            &#10;            // Register the factory with your factory registry&#10;            RegisterEntityFactory(entityKey, factory);&#10;        }&#10;    }&#10;&#10;    private void SetupTerrainFactories()&#10;    {&#10;        foreach (var terrainKey in GameData.Terrain.Keys)&#10;        {&#10;            var terrainData = GameData.GetTerrainData(terrainKey);&#10;            &#10;            // Create an AdvancedFactory for each terrain type&#10;            var factory = new AdvancedFactory&lt;Terrain&gt;(() =&gt; {&#10;                var terrain = new Terrain();&#10;                &#10;                // Configure terrain from JSON data&#10;                terrain.Name = terrainData[&quot;name&quot;]?.Value&lt;string&gt;() ?? terrainKey;&#10;                terrain.Blocking = terrainData[&quot;blocking&quot;]?.Value&lt;bool&gt;() ?? false;&#10;                terrain.Sprite = terrainData[&quot;sprite&quot;]?.Value&lt;string&gt;() ?? &quot;default_sprite&quot;;&#10;                &#10;                if (terrainData[&quot;openable&quot;] != null)&#10;                {&#10;                    terrain.Openable = terrainData[&quot;openable&quot;].Value&lt;bool&gt;();&#10;                }&#10;                &#10;                return terrain;&#10;            });&#10;            &#10;            // Register the factory with your factory registry&#10;            RegisterTerrainFactory(terrainKey, factory);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Scripts/GameBalance.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Scripts/GameBalance.cs" />
              <option name="originalContent" value="namespace Mut8.Scripts&#10;{&#10;    /// &lt;summary&gt;&#10;    /// Contains all game balance constants for tuning gameplay.&#10;    /// &lt;/summary&gt;&#10;    internal static class GameBalance&#10;    {&#10;        // Health related constants&#10;        public const int BaseMaxHP = 100;&#10;        public const float StoutGeneHPMultiplier = 20f;&#10;&#10;        // Gene effectiveness multipliers (for future use)&#10;        public const float StrongGeneAttackMultiplier = 1f;&#10;        public const float QuickGeneSpeedMultiplier = 1f;&#10;        public const float ResilientGeneDefenseMultiplier = 1f;&#10;        public const float SmartGeneXPMultiplier = 1f;&#10;        public const float StealthyGeneDetectionMultiplier = 1f;&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="namespace Mut8.Scripts&#10;{&#10;    /// &lt;summary&gt;&#10;    /// Contains all game balance constants for tuning gameplay.&#10;    /// &lt;/summary&gt;&#10;    internal static class GameBalance&#10;    {&#10;        // Health related constants&#10;        public const float BaseMaxHP = 100f;&#10;        public const float StoutGeneHPMultiplier = 20f;&#10;&#10;        // Gene effectiveness multipliers (for future use)&#10;        public const float StrongGeneAttackMultiplier = 1f;&#10;        public const float QuickGeneSpeedMultiplier = 1f;&#10;        public const float ResilientGeneDefenseMultiplier = 1f;&#10;        public const float SmartGeneXPMultiplier = 1f;&#10;        public const float StealthyGeneDetectionMultiplier = 1f;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Scripts/MapObjects/Components/Mutator.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Scripts/MapObjects/Components/Mutator.cs" />
              <option name="updatedContent" value="using GoRogue.GameFramework;&#10;using SadRogue.Integration;&#10;using SadRogue.Integration.Components;&#10;using SadRogue.Primitives;&#10;&#10;namespace Mut8.Scripts.MapObjects.Components&#10;{&#10;    /// &lt;summary&gt;&#10;    /// Component that monitors surrounding tiles for Genome components and tracks the highest gene values.&#10;    /// &lt;/summary&gt;&#10;    internal class Mutator : RogueLikeComponentBase&lt;RogueLikeEntity&gt;&#10;    {&#10;        private readonly Dictionary&lt;Gene, float&gt; _surroundingGenes;&#10;        &#10;        public IReadOnlyDictionary&lt;Gene, float&gt; SurroundingGenes =&gt; _surroundingGenes;&#10;&#10;        public Mutator() : base(false, false, false, false)&#10;        {&#10;            _surroundingGenes = new Dictionary&lt;Gene, float&gt;();&#10;        }&#10;&#10;        protected override void OnAdded(RogueLikeEntity item)&#10;        {&#10;            base.OnAdded(item);&#10;            &#10;            // Register for position changes&#10;            if (item != null)&#10;            {&#10;                item.PositionChanged += OnPositionChanged;&#10;                // Initial scan&#10;                UpdateSurroundingGenes();&#10;            }&#10;        }&#10;&#10;        protected override void OnRemoved(RogueLikeEntity item)&#10;        {&#10;            base.OnRemoved(item);&#10;            &#10;            // Unregister from position changes&#10;            if (item != null)&#10;            {&#10;                item.PositionChanged -= OnPositionChanged;&#10;            }&#10;        }&#10;&#10;        private void OnPositionChanged(object? sender, ValueChangedEventArgs&lt;Point&gt; e)&#10;        {&#10;            UpdateSurroundingGenes();&#10;        }&#10;&#10;        /// &lt;summary&gt;&#10;        /// Scans the 8 surrounding tiles for Genome components and tracks the highest value for each gene.&#10;        /// &lt;/summary&gt;&#10;        private void UpdateSurroundingGenes()&#10;        {&#10;            if (Parent?.CurrentMap == null) return;&#10;&#10;            // Clear previous data&#10;            _surroundingGenes.Clear();&#10;&#10;            // Check all 8 adjacent positions&#10;            var adjacentPositions = AdjacencyRule.EightWay.DirectionsOfNeighborsCache;&#10;            &#10;            foreach (var direction in adjacentPositions)&#10;            {&#10;                var checkPos = Parent.Position + direction;&#10;                &#10;                // Skip if position is out of bounds&#10;                if (!Parent.CurrentMap.Contains(checkPos)) continue;&#10;&#10;                // Check all objects at this position for Genome components&#10;                foreach (var obj in Parent.CurrentMap.GetObjectsAt(checkPos))&#10;                {&#10;                    var genome = obj.GoRogueComponents.GetFirstOrDefault&lt;Genome&gt;();&#10;                    if (genome == null) continue;&#10;&#10;                    // Check each gene in the genome&#10;                    foreach (var genePair in genome.Genes)&#10;                    {&#10;                        var gene = genePair.Key;&#10;                        var value = genePair.Value;&#10;&#10;                        // Update dictionary if this is a higher value&#10;                        if (!_surroundingGenes.ContainsKey(gene) || _surroundingGenes[gene] &lt; value)&#10;                        {&#10;                            _surroundingGenes[gene] = value;&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        /// &lt;summary&gt;&#10;        /// Manually triggers an update of surrounding genes.&#10;        /// &lt;/summary&gt;&#10;        public void Refresh()&#10;        {&#10;            UpdateSurroundingGenes();&#10;        }&#10;&#10;        /// &lt;summary&gt;&#10;        /// Gets the highest value for a specific gene in the surrounding area.&#10;        /// &lt;/summary&gt;&#10;        public float GetSurroundingGene(Gene gene)&#10;        {&#10;            return _surroundingGenes.TryGetValue(gene, out var value) ? value : 0f;&#10;        }&#10;&#10;        /// &lt;summary&gt;&#10;        /// Checks if a specific gene exists in the surrounding area.&#10;        /// &lt;/summary&gt;&#10;        public bool HasSurroundingGene(Gene gene)&#10;        {&#10;            return _surroundingGenes.ContainsKey(gene);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/IMutationStrategy.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/IMutationStrategy.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Mutant.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Mutant.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/MutationEngine.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/MutationEngine.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/ArithmeticOperatorMutation.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/ArithmeticOperatorMutation.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/BooleanLiteralMutation.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/BooleanLiteralMutation.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/ConditionalBoundaryMutation.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/ConditionalBoundaryMutation.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/LogicalOperatorMutation.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/LogicalOperatorMutation.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/NegateConditionalMutation.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Mutations/Strategies/NegateConditionalMutation.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Testing/ITestRunner.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Testing/ITestRunner.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/../../../../../src/Mut8.Core/Testing/TestRunner.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/../../../../../src/Mut8.Core/Testing/TestRunner.cs" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>